{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Dhruv Garg\\\\MY SHOPING CART\\\\client\\\\src\\\\context\\\\CartContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect, useContext } from 'react';\nimport api from '../utils/api';\nimport { AuthContext } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const CartContext = /*#__PURE__*/createContext();\nexport const CartProvider = ({\n  children\n}) => {\n  _s();\n  const [cart, setCart] = useState({\n    cartItems: []\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const {\n    isAuthenticated,\n    token\n  } = useContext(AuthContext);\n\n  // Fetch cart when user logs in\n  useEffect(() => {\n    if (isAuthenticated) {\n      fetchCart();\n    } else {\n      // Clear cart when user logs out\n      setCart({\n        cartItems: []\n      });\n    }\n  }, [isAuthenticated]);\n\n  // Fetch cart from API\n  const fetchCart = async () => {\n    if (!isAuthenticated) return;\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await api.get('/carts');\n      setCart(res.data.cart);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || 'Failed to fetch cart');\n      console.error('Error fetching cart:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Add item to cart\n  const addToCart = async (itemId, quantity = 1) => {\n    if (!isAuthenticated) {\n      // Handle guest cart or redirect to login\n      return {\n        success: false,\n        error: 'Please login to add items to cart'\n      };\n    }\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await api.post('/carts', {\n        item_id: itemId,\n        quantity\n      });\n      setCart(res.data.cart);\n      return {\n        success: true\n      };\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      const errorMsg = ((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.error) || 'Failed to add item to cart';\n      setError(errorMsg);\n      console.error('Error adding to cart:', err);\n      return {\n        success: false,\n        error: errorMsg\n      };\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Remove item from cart\n  const removeFromCart = async itemId => {\n    if (!isAuthenticated) return;\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await api.delete(`/carts/${itemId}`);\n      setCart(res.data.cart);\n      return {\n        success: true\n      };\n    } catch (err) {\n      var _err$response3, _err$response3$data;\n      const errorMsg = ((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.error) || 'Failed to remove item from cart';\n      setError(errorMsg);\n      console.error('Error removing from cart:', err);\n      return {\n        success: false,\n        error: errorMsg\n      };\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Create order from cart\n  const checkout = async () => {\n    if (!isAuthenticated) return;\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await api.post('/orders', {});\n      // Clear cart after successful checkout\n      setCart({\n        cartItems: []\n      });\n      return {\n        success: true,\n        order: res.data.order\n      };\n    } catch (err) {\n      var _err$response4, _err$response4$data;\n      const errorMsg = ((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.error) || 'Checkout failed';\n      setError(errorMsg);\n      console.error('Error during checkout:', err);\n      return {\n        success: false,\n        error: errorMsg\n      };\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Calculate cart total\n  const getCartTotal = () => {\n    return cart.cartItems.reduce((total, item) => {\n      return total + item.item.price * item.quantity;\n    }, 0);\n  };\n\n  // Get cart item count\n  const getCartItemCount = () => {\n    return cart.cartItems.reduce((count, item) => count + item.quantity, 0);\n  };\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: {\n      cart,\n      loading,\n      error,\n      fetchCart,\n      addToCart,\n      removeFromCart,\n      checkout,\n      getCartTotal,\n      getCartItemCount,\n      cartItems: cart.cartItems || []\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 121,\n    columnNumber: 5\n  }, this);\n};\n_s(CartProvider, \"asYI1SCHtpUUoIuNVoIdTibBjT8=\");\n_c = CartProvider;\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","api","AuthContext","jsxDEV","_jsxDEV","CartContext","CartProvider","children","_s","cart","setCart","cartItems","loading","setLoading","error","setError","isAuthenticated","token","fetchCart","res","get","data","err","_err$response","_err$response$data","response","console","addToCart","itemId","quantity","success","post","item_id","_err$response2","_err$response2$data","errorMsg","removeFromCart","delete","_err$response3","_err$response3$data","checkout","order","_err$response4","_err$response4$data","getCartTotal","reduce","total","item","price","getCartItemCount","count","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Dhruv Garg/MY SHOPING CART/client/src/context/CartContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from 'react';\nimport api from '../utils/api';\nimport { AuthContext } from './AuthContext';\n\nexport const CartContext = createContext();\n\nexport const CartProvider = ({ children }) => {\n  const [cart, setCart] = useState({ cartItems: [] });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const { isAuthenticated, token } = useContext(AuthContext);\n\n  // Fetch cart when user logs in\n  useEffect(() => {\n    if (isAuthenticated) {\n      fetchCart();\n    } else {\n      // Clear cart when user logs out\n      setCart({ cartItems: [] });\n    }\n  }, [isAuthenticated]);\n\n  // Fetch cart from API\n  const fetchCart = async () => {\n    if (!isAuthenticated) return;\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const res = await api.get('/carts');\n      setCart(res.data.cart);\n    } catch (err) {\n      setError(err.response?.data?.error || 'Failed to fetch cart');\n      console.error('Error fetching cart:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Add item to cart\n  const addToCart = async (itemId, quantity = 1) => {\n    if (!isAuthenticated) {\n      // Handle guest cart or redirect to login\n      return { success: false, error: 'Please login to add items to cart' };\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const res = await api.post('/carts', { item_id: itemId, quantity });\n      setCart(res.data.cart);\n      return { success: true };\n    } catch (err) {\n      const errorMsg = err.response?.data?.error || 'Failed to add item to cart';\n      setError(errorMsg);\n      console.error('Error adding to cart:', err);\n      return { success: false, error: errorMsg };\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Remove item from cart\n  const removeFromCart = async (itemId) => {\n    if (!isAuthenticated) return;\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const res = await api.delete(`/carts/${itemId}`);\n      setCart(res.data.cart);\n      return { success: true };\n    } catch (err) {\n      const errorMsg = err.response?.data?.error || 'Failed to remove item from cart';\n      setError(errorMsg);\n      console.error('Error removing from cart:', err);\n      return { success: false, error: errorMsg };\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Create order from cart\n  const checkout = async () => {\n    if (!isAuthenticated) return;\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const res = await api.post('/orders', {});\n      // Clear cart after successful checkout\n      setCart({ cartItems: [] });\n      return { success: true, order: res.data.order };\n    } catch (err) {\n      const errorMsg = err.response?.data?.error || 'Checkout failed';\n      setError(errorMsg);\n      console.error('Error during checkout:', err);\n      return { success: false, error: errorMsg };\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Calculate cart total\n  const getCartTotal = () => {\n    return cart.cartItems.reduce((total, item) => {\n      return total + (item.item.price * item.quantity);\n    }, 0);\n  };\n\n  // Get cart item count\n  const getCartItemCount = () => {\n    return cart.cartItems.reduce((count, item) => count + item.quantity, 0);\n  };\n\n  return (\n    <CartContext.Provider\n      value={{\n        cart,\n        loading,\n        error,\n        fetchCart,\n        addToCart,\n        removeFromCart,\n        checkout,\n        getCartTotal,\n        getCartItemCount,\n        cartItems: cart.cartItems || []\n      }}\n    >\n      {children}\n    </CartContext.Provider>\n  );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}